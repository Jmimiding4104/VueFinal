"use strict";(self["webpackChunkVueFinal"]=self["webpackChunkVueFinal"]||[]).push([[573],{5573:function(t,e,s){s.r(e),s.d(e,{default:function(){return O}});var a=s(6252),o=s(3577),d=s(9963);const i={class:"wrap"},r={class:"order-container"},l={class:"orderpage"},n={class:"orderhead"},c=(0,a._)("h2",null,"您的購物車",-1),u={class:"clear-cart"},h={class:"table align-middle"},p=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{style:{width:"240px"}}),(0,a._)("th",{style:{width:"240px"},class:"text-center"},"品項"),(0,a._)("th",{style:{width:"240px"},class:"text-center"},"數量/單位"),(0,a._)("th",{style:{width:"240px"},class:"text-center"},"單價"),(0,a._)("th",{style:{width:"40px"}})])],-1),g={class:"order-img"},_=["src"],m={class:"text-center"},v={class:"input-group input-group-sm"},b={class:"input-group mb-3"},y=["onUpdate:modelValue","onChange","disabled"],C=["value"],x={class:"input-group-text",id:"basic-addon2"},w={class:"text-center"},$=["onClick","disabled"],f={class:"order-tfooter"},j={colspan:"3"},k={class:"ordercoupn"},M=(0,a._)("td",{colspan:"1",class:"text-end"},"總計",-1),D={class:"text-end"},I={key:0},L=(0,a._)("td",{colspan:"4",class:"text-end"},"折扣後價格",-1),q={class:"text-end"},P={class:"order-footer"},V={class:"order-next"},z={class:"order-next"},F=(0,a._)("div",{class:"footer"},[(0,a._)("p",null,"此網站非實際運營之網站，僅為學習用途。")],-1);function U(t,e,s,U,Z,H){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[(0,a._)("div",r,[(0,a._)("div",null,[(0,a._)("div",l,[(0,a._)("div",n,[c,(0,a._)("div",u,[(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=t=>H.delCarts())}," 刪除所有產品 ")])]),(0,a._)("table",h,[p,(0,a._)("tbody",null,[Z.cartData.carts?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(Z.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",g,[(0,a._)("img",{src:t.product.imageUrl,class:"card-img-top",alt:"..."},null,8,_)]),(0,a._)("td",m,(0,o.zw)(t.product.title),1),(0,a._)("td",null,[(0,a._)("div",v,[(0,a._)("div",b,[(0,a.wy)((0,a._)("select",{id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>H.updateCarts(t),disabled:Z.isLoading===t.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(100,(e=>(0,a._)("option",{value:e,key:`${e}${t.id}`},(0,o.zw)(e),9,C))),64))],40,y),[[d.bM,t.qty]]),(0,a._)("span",x,(0,o.zw)(t.product.unit),1)])])]),(0,a._)("td",w,(0,o.zw)(t.final_total),1),(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>H.delCartItem(t.id),disabled:Z.isLoading===t.id}," x ",8,$)])])))),128)):(0,a.kq)("",!0)]),(0,a._)("tfoot",f,[(0,a._)("tr",null,[(0,a._)("td",j,[(0,a._)("div",k,[(0,a.wy)((0,a._)("input",{type:"text",id:"coupon","onUpdate:modelValue":e[1]||(e[1]=t=>Z.couponCode=t),placeholder:"請輸入優惠碼"},null,512),[[d.nr,Z.couponCode]]),(0,a._)("button",{class:"btn btn-primary",type:"button",onClick:e[2]||(e[2]=t=>H.useCoupon())}," 折抵GO ")])]),M,(0,a._)("td",D,(0,o.zw)(Z.cartData.total),1)]),0!=Z.couponMoney.length?((0,a.wg)(),(0,a.iD)("tr",I,[L,(0,a._)("td",q,(0,o.zw)(Z.couponMoney),1)])):(0,a.kq)("",!0)])]),(0,a._)("div",P,[(0,a._)("div",V,[(0,a._)("button",{type:"submit",class:"btn btn-primary",onClick:e[3]||(e[3]=(0,d.iM)((t=>this.$router.push("/Products")),["prevent"]))}," 繼續購物 ")]),(0,a._)("div",z,[(0,a._)("button",{type:"submit",class:"btn btn-primary",onClick:e[4]||(e[4]=(0,d.iM)((t=>H.nextView()),["prevent"]))}," 下一步 ")])])])])])]),F],64)}var Z=s(4902),H={data(){return{cartData:{},products:[],product:{},deleteAllCarts:{},cart:{},productId:"",isLoading:"",form:{user:{email:"",name:"",address:"",tel:""},message:""},couponCode:"",couponMoney:"",orderStatus:!1,orderId:""}},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/godjj/products/all").then((t=>{this.products=t.data.products})).catch((t=>{alert(t.data.message)}))},getCarts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/godjj/cart").then((t=>{this.cartData=t.data.data})).catch((t=>{alert(t.data.message)}))},addToCart(t,e=1){const s={product_id:t,qty:e};this.isLoading=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/godjj/cart",{data:s}).then((t=>{this.getCarts(),this.isLoading="",Z.Z.emit("get-cart")})).catch((t=>{alert(t.data.message)}))},delCartItem(t){this.isLoading=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/godjj/cart/${t}`).then((t=>{this.getCarts(),this.isLoading="",Z.Z.emit("get-cart")})).catch((t=>{alert(t.data.message)}))},delCarts(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/godjj/carts").then((t=>{alert("已成功清除購物車"),this.getCarts(),Z.Z.emit("get-cart")})).catch((t=>{alert(t.data.message)}))},updateCarts(t){const e={product_id:t.id,qty:t.qty};this.isLoading=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/godjj/cart/${t.id}`,{data:e}).then((t=>{this.getCarts(),this.isLoading=""})).catch((t=>{alert(t.data.message)}))},useCoupon(){const t="https://vue3-course-api.hexschool.io/v2/api/godjj/coupon",e=this.couponCode;this.$http.post(t,{data:{code:e}}).then((t=>{console.log(t),this.couponMoney=t.data.data.final_total}))},nextView(){this.$router.push("/FillIn")},goPay(){const{id:t}=this.$route.params;this.$http.post(`https://vue3-course-api.hexschool.io/v2/api/godjj/pay/${t}`).then((t=>{alert(t.data.message),console.log(t),this.$router.push(`/Finish/${this.orderId}`)}))},sendOrder(){const t="https://vue3-course-api.hexschool.io/v2/api/godjj/order",e={user:this.form.user,message:this.form.message};console.log(e),this.$http.post(t,{data:e}).then((t=>{this.orderId=t.data.orderId,console.log(this.orderId),alert(t.data.message),this.$refs.form.resetForm(),this.goPay()})).catch((t=>{console.log(t)}))},isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的電話號碼"},openModal(t){this.$refs.CartModal.openModal(),this.productId=t,this.$refs.CartModal.getProduct()}},mounted(){this.getProducts(),this.getCarts()}},Y=s(3744);const K=(0,Y.Z)(H,[["render",U]]);var O=K}}]);
//# sourceMappingURL=573.b7f9c8e0.js.map